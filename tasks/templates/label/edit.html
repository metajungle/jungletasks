{% extends "base.html" %}

{% block script %}
<script id="label-delete-confirm-template" type="text/x-handlebars-template">
{% verbatim %}
<form action="/label/delete/{{id}}/" method="POST">
{% endverbatim %}
{% csrf_token %}
{% verbatim %}
<input type="submit" class="btn btn-danger btn-sm btn-confirm btn-delete-confirm" value="Are you sure?" />
<button type="button" class="btn btn-default btn-sm btn-confirm btn-delete-cancel">No</button>
</form>
{% endverbatim %}
</script>
{% endblock script %}

{% block js-on-document-load %}

/* focus on label text */
setInterval(function() {
    $("#label").focus();
}, 200);

$(".btn-delete").click(function() {
    // hide the button just clicked 
    $(this).hide();

    // create the form to delete the label 
    var id = $(this).data('id');
    var source = $("#label-delete-confirm-template").html();
    var template = Handlebars.compile(source);
    var html = template({id: id});
    $(this).after(html);
    
    // register the cancel event 
    $('.btn-delete-cancel').click(function(e) {
        // remove the confirmation set of buttons 
        $(".btn-confirm").remove();
        // bring back the original button
       $(".btn-delete").show(); 
       e.stopPropagation();
    });
});

{% endblock %}

{% block contents %}

{% block page_header %}
<h1>Edit Label</h1>
{% endblock %}

<form action="" method="POST" class="pure-form pure-form-stacked">{% csrf_token %}
    <fieldset>
        <label for="label">Label</label>
        <input id="label" name="label" type="text" placeholder="Label" value="{{ label.name }}" class="pure-input-1"></input>

        <button type="submit" class="pure-button pure-button-small pure-button-primary">Update</button>
    </fieldset>
</form>

<p></p>

<button type="submit" class="pure-button pure-button-small pure-button-error btn-delete" data-id="{{ label.id }}">Delete label</button>

{% endblock %}
